# Phase 12: Final Cleanup and Documentation - Plan 01

## Deprecated Code Removal and TODO Cleanup

**Created:** 2026-01-12
**Status:** Ready for Execution
**Estimated Tasks:** 6

---

## Context

### TODO/FIXME Analysis

| Location | Type | Action |
|----------|------|--------|
| `handlers/chat_handler.go:22` | TODO(phase-12) | Remove file |
| `handlers/location_handler.go:21` | TODO(phase-12) | Remove file |
| `internal/handlers/location.go:16` | TODO(phase-12) | Remove file |
| `internal/store/interfaces.go:183` | TODO(phase-12) | Remove LocationStore interface |
| `internal/store/interfaces.go:208` | TODO(phase-12) | Remove NotificationStore interface |
| `logger/logger.go:47` | TODO | Change to NOTE (future enhancement) |
| `internal/errors/errors.go:10` | TODO | Change to NOTE (already appropriate scope) |

### Files to Remove

1. `handlers/chat_handler.go` - Deprecated, superseded by ChatHandlerSupabase
2. `handlers/location_handler.go` - Deprecated, superseded by LocationHandlerSupabase
3. `internal/handlers/location.go` - Deprecated, security gap (no auth checks)
4. `internal/handlers/location_test.go` - Tests for deprecated handler

### Integration Test TODOs (Out of Scope)

These are documentation TODOs for test implementation, not production code issues:
- `tests/integration/trip_test.go:12` - TODO for implementing tests
- `tests/integration/invitation_integration_test.go:220, 434` - Migration and test case TODOs

---

## Objective

Complete the v1.0 Codebase Refactoring milestone by:
1. Removing all Phase 12-marked deprecated code
2. Converting remaining TODOs to NOTEs where appropriate
3. Ensuring clean build and no critical TODOs remain

---

## Tasks

### Task 1: Remove handlers/chat_handler.go

**Action:** Delete the deprecated ChatHandler file.

This handler is:
- Not routed (no routes point to its methods)
- Superseded by ChatHandlerSupabase
- Only exists for historical reference

---

### Task 2: Remove handlers/location_handler.go

**Action:** Delete the deprecated LocationHandler file.

This handler is:
- Not routed (no routes point to its methods)
- Superseded by LocationHandlerSupabase
- Only instantiated in main.go but never used

**Also update:**
- `main.go` - Remove LocationHandler instantiation (~lines 254-259)
- `main.go` - Remove LocationHandler from routerDeps (~line 290)
- `router/router.go` - Remove LocationHandler from Dependencies struct (line 31)

---

### Task 3: Remove internal/handlers/location.go and tests

**Action:** Delete the deprecated internal LocationHandler files.

These files:
- Bypass the service layer (direct store access)
- Have NO authorization checks (security gap)
- Are not routed anywhere

**Files to delete:**
- `internal/handlers/location.go`
- `internal/handlers/location_test.go`

---

### Task 4: Remove deprecated store interfaces

**File:** `internal/store/interfaces.go`

**Remove:**
1. `LocationStore` interface (lines 178-202)
   - Only used by deprecated internal/handlers/location.go
   - Different signatures from store/location_store.go

2. `NotificationStore` interface (lines 204-228+)
   - Unused, different from store/notification_store.go
   - Exists for unused Store.Notification() pattern

---

### Task 5: Update logger.go TODO

**File:** `logger/logger.go`

**Before:**
```go
// TODO: Configure actual cloudwatch paths if needed
```

**After:**
```go
// NOTE: CloudWatch integration available if needed in future.
// Current setup uses stdout/stderr which works with container logging.
```

---

### Task 6: Update internal/errors/errors.go TODO

**File:** `internal/errors/errors.go`

**Before:**
```go
// TODO: Consider making these more generic if used outside trips
```

**After:**
```go
// NOTE: These error codes are trip-domain specific by design.
// Generic error codes exist in errors/errors.go for cross-domain use.
```

---

## Files Modified/Removed

| File | Action |
|------|--------|
| `handlers/chat_handler.go` | Delete |
| `handlers/location_handler.go` | Delete |
| `internal/handlers/location.go` | Delete |
| `internal/handlers/location_test.go` | Delete |
| `main.go` | Remove LocationHandler references |
| `router/router.go` | Remove LocationHandler from Dependencies |
| `internal/store/interfaces.go` | Remove LocationStore and NotificationStore |
| `logger/logger.go` | Update TODO to NOTE |
| `internal/errors/errors.go` | Update TODO to NOTE |

---

## Success Criteria

- [ ] All Phase 12-marked files removed
- [ ] No references to removed handlers remain
- [ ] `go build ./...` passes
- [ ] No critical TODO/FIXME remaining in production code
- [ ] All tests pass

---

*Phase: 12-final-cleanup-documentation*
*Plan: 12-01*
*Created: 2026-01-12*
